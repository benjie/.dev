<!doctype html>
<html lang="en-GB" dir="ltr" class="docs-wrapper plugin-docs plugin-id-rfcs docs-version-current docs-doc-page docs-doc-id-FragmentModularity" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.0">
<title data-rh="true">Fragment Modularity | benjie.dev</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://benjie.dev/rfcs/FragmentModularity"><meta data-rh="true" property="og:locale" content="en_GB"><meta data-rh="true" name="docusaurus_locale" content="en-GB"><meta data-rh="true" name="docsearch:language" content="en-GB"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-rfcs-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-rfcs-current"><meta data-rh="true" property="twitter:title" content="Fragment Modularity | benjie.dev"><meta data-rh="true" property="og:title" content="Fragment Modularity | benjie.dev"><meta data-rh="true" name="description" content="At a glance"><meta data-rh="true" property="og:description" content="At a glance"><meta data-rh="true" property="og:image" content="https://benjie.dev/img/rfc_tracker.png"><meta data-rh="true" name="twitter:image" content="https://benjie.dev/img/rfc_tracker.png"><link data-rh="true" rel="icon" href="/favicon.ico"><link data-rh="true" rel="canonical" href="https://benjie.dev/rfcs/FragmentModularity"><link data-rh="true" rel="alternate" href="https://benjie.dev/rfcs/FragmentModularity" hreflang="en-GB"><link data-rh="true" rel="alternate" href="https://benjie.dev/rfcs/FragmentModularity" hreflang="x-default"><script src="https://assets.calendly.com/assets/external/widget.js"></script><link rel="stylesheet" href="/assets/css/styles.c47278a5.css">
<script src="/assets/js/runtime~main.d761eaf9.js" defer="defer"></script>
<script src="/assets/js/main.e1368ecd.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/avatar.jpg" alt="benjie" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/avatar.jpg" alt="benjie" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">benjie.dev</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/rfcs/">RFCs</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/book">📞 Book a call</a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rfcs/">GraphQL RFC Tracker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rfcs/activity">Activity</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/rfcs/525">Stage 3: Accepted</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/rfcs/793">Stage 2: Draft</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/793">793*: Default value coercion rules [RFC2]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/825">825*: OneOf Input Objects [RFC2]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/860">860*: Prevent @skip and @include on root subscription selection set [RFC2]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/1053">1053*: Implementations may not deprecate a field that the interface hasn&#x27;t deprecated [RFC2]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/1063">1063*: Type system ordering of: object interfaces, directive arguments, input object fields, enum values [RFC2]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/1092">1092*: Recommend that order of unordered collections is maintained where possible [RFC2]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/1102">1102*: Define Data Collections used in the spec [RFC2]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/1142">1142: make `includeDeprecated` non nullable [RFC2]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/1081">1081: Fragment arguments/variables (syntax/validation/execution) [RFC2]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/794">794: Schema Coordinates [RFC2]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/955">955: Add validation rule that operation types exist [RFC2]</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/rfcs/1153">Stage 1: Proposal</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/1153">1153*: Allow clients to disable error propagation via request parameter [RFC1]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/1058">1058*: List coercion algorithm [RFC1]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/1056">1056*: Fix CoerceArgumentValues() hasValue [RFC1]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/1110">1110: Incremental Delivery spec draft [RFC1]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/1127">1127*: When `sourceStream` errors, yield a `{ errors: [...] }` response [RFC1]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/997">997: Expand @deprecated to Objects [RFC1]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/1059">1059*: Introduce Strict and Legacy All Variable Usages Are Allowed [RFC1]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/950">950: allow unions to include interfaces and unions [RFC1]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/939">939: allow unions to declare implementation of interfaces [RFC1]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/907">907: Add support for directives on directives [RFC1]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/892">892: Add descriptions to executable definitions [RFC1]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/509">509: Allow singular variables in list locations [RFC1]</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/rfcs/1065">Stage 0: Strawman</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/1065">1065*: SemanticNonNull type (null only on error) [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/SemanticNullability">SemanticNullability: Semantic Nullability [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/wg1700">wg1700: Lee&#x27;s new nullability &amp; error propagation proposal [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/DisableErrorPropagationDirective">DisableErrorPropagationDirective: Disable Error Propagation Directive [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/1050">1050*: Directive proposal for opting out of null bubbling [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/ClientControlledNullability">ClientControlledNullability: Client Controlled Nullability [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/1114">1114: add __directive meta field parallel to __type [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/1057">1057*: Fix coercion table for list [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/DeferStream">DeferStream: GraphQL Defer and Stream Directives [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/SchemaCoordinates">SchemaCoordinates: Schema Coordinates [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/InputUnion">InputUnion: GraphQL Input Union [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/FeatureDiscovery">FeatureDiscovery: Feature Discovery [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/Struct">Struct: Polymorphic-capable composite symmetric input/output type (`struct`) [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/1049">1049: Introduce SourceSchemaDocument and FullSchemaDocument [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/wg1410">wg1410: Strict Semantic Nullability [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/wg1394">wg1394: True Nullability Schema [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/1045">1045*: Remove fragmentSpreadName from visitedFragments when visit is complete [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/FullSchemas">FullSchemas: Full Schemas [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/1015">1015: &quot;Root&quot; Types clarity → &quot;Operation Type&quot; [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/FragmentArguments">FragmentArguments: Fragment Arguments [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/wg1239">wg1239: Fragment Arguments: RFC + Implementation Details [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/998">998: add spec edits for references [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/OptInFeatures">OptInFeatures: Opt-in features [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/ExpandingSubtyping">ExpandingSubtyping: Expanding Subtyping (for output types) [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/AnnotationStructs">AnnotationStructs: Annotation Structs [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/MetadataStructs">MetadataStructs: Metadata Structs [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/wg1096">wg1096: &quot;Metadata Directives&quot; Proposal [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/CompositeSchemas">CompositeSchemas: GraphQL Composite Schemas [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/wg1071">wg1071*: Struct type [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/673">673: Servers must preserve lexical ordering between SDL and introspection [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/948">948*: OneOf Objects [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/wg944">wg944: New Intersection Type [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/wg857">wg857: Fragment Modularity [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/rfcs/FragmentModularity">FragmentModularity: Fragment Modularity [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/wg815">wg815: Nested GraphQL Mutations [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/ImplicitInheritance">ImplicitInheritance: Implicit Inheritance [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/OperationExpressions">OperationExpressions: Operation Expressions [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/SchemaFragments">SchemaFragments: Schema Fragments [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/879">879: __fulfilled meta field [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/Subscriptions">Subscriptions: NOTE: this document is kept for historic purposes; GraphQL Subscriptions have been specified and released as part of the official [June 2018 GraphQL Specification](https://spec.graphql.org/June2018/). [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/710">710: Add namedType and punctuatedName to __Type [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/706">706: Add support for directives for an object field name [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/674">674: allow empty selections [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/631">631: Make root query operation type optional [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/567">567: allow directives on directive definitions [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/556">556: Document Directives [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/521">521: Scalar serialize as built-in scalar type [RFC0]</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rfcs/325">325: Add &quot;Any&quot; scalar type [RFC0]</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/rfcs/1091">Stage X: Rejected</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Fragment Modularity</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="at-a-glance">At a glance<a href="#at-a-glance" class="hash-link" aria-label="Direct link to At a glance" title="Direct link to At a glance">​</a></h2>
<ul>
<li><strong>Identifier</strong>: FragmentModularity</li>
<li><strong>Stage</strong>: <a href="https://github.com/graphql/graphql-spec/blob/main/CONTRIBUTING.md#stage-0-strawman" target="_blank" rel="noopener noreferrer">RFC0: Strawman</a></li>
<li><strong>Champion</strong>: -</li>
<li><strong>PR</strong>: -</li>
<li><strong>Related</strong>:<!-- -->
<ul>
<li><a title="Fragment Arguments (parameterized fragments) for GraphQL / RFCX" href="/rfcs/865">#865</a> (Fragment Arguments (parameterized fragments) for GraphQL)</li>
<li><a title="__fulfilled meta field / RFC0" href="/rfcs/879">#879</a> (__fulfilled meta field)</li>
<li><a title="Client Controlled Nullability / RFCX" href="/rfcs/895">#895</a> (Client Controlled Nullability)</li>
<li><a title="Client Controlled Nullability / RFC0" href="/rfcs/ClientControlledNullability">ClientControlledNullability</a> (Client Controlled Nullability)</li>
<li><a title="Fragment Modularity / RFC0" href="/rfcs/wg857">wg#857</a> (Fragment Modularity)</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="timeline">Timeline<a href="#timeline" class="hash-link" aria-label="Direct link to Timeline" title="Direct link to Timeline">​</a></h2>
<ul>
<li><strong><a href="https://github.com/graphql/graphql-wg/blob/d6103434afc3e516240f7b53721eb7b728ca525c/rfcs/FragmentModularity.md" target="_blank" rel="noopener noreferrer">RFC document created</a></strong> on 2022-01-06 by Matt Mahoney</li>
</ul>
<hr>
<blockquote>
<h1>RFC: Fragment Modularity</h1>
<p><strong>Proposed by:</strong></p>
<ul>
<li><a href="https://github.com/mjmahone" target="_blank" rel="noopener noreferrer">Matt Mahoney</a> - Facebook</li>
</ul>
<p><strong>Contributors:</strong></p>
<ul>
<li><a href="https://github.com/josephsavona" target="_blank" rel="noopener noreferrer">Joe Savona</a> - Facebook</li>
<li><a href="https://github.com/captbaritone" target="_blank" rel="noopener noreferrer">Jordan Eldredge</a> - Facebook</li>
<li>You?</li>
</ul>
<p>GraphQL was originally designed to support building mobile applications, where for performance reasons applications need to fetch the minimum amount of data needed for a given UI surface and aggregate requests into fewer network requests. In parallel with GraphQL’s evolution, component-oriented UI frameworks (ie React) gained traction, supporting a style in which applications could be broken down into modular, reusable components. GraphQL fragments were a natural way for components to describe their data dependencies in a <em>mostly</em> modular and reusable way, and Relay and other GraphQL clients have taken this approach to its logical extreme and use fragments as a fundamental unit in their APIs and architectures.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="problem-statement">Problem Statement<a href="#problem-statement" class="hash-link" aria-label="Direct link to Problem Statement" title="Direct link to Problem Statement">​</a></h2>
<p>Unfortunately the “fragments are like components but for data” analogy breaks down because — unlike UI components in typical frameworks — <strong>fragments are not truly reusable or modular</strong>. We discuss reusability in other RFCs, but this RFC focuses specifically on fragment’s lack of <strong>modularity</strong>. The core challenge is that in GraphQL-the-spec, fragments are facades: <code>...Foo</code> is no different than having copy-pasted the selections of <code>Foo</code> (and its type condition) at the same location. This “spread” or inlining behavior breaks encapsulation of fragments and causes several concrete challenges to designing robust GraphQL clients, and in turn to application developers:</p>
<ul>
<li>Developers cannot reason about fragments in isolation. Because the results of a fragment are spread/inlined at their usage site, GraphQL requires global validations such as preventing conflicting fields/arguments at a given path in the response. Developers frequently have to come up with arbitrary aliases for fields as a way to avoid accidental collisions with unrelated code — breaking encapsulation.</li>
<li>Similarly, build tools must implement these whole-program validations, making the cost to changes O(codebase) rather than O(changed fragment). Because any change to a fragment could break the no-conflicting-aliases rule, any change to any fragment has to be checked against all the operations that transitively reference that fragment. Developers see this in the form of slower builds and slower tools, and rightfully attribute this as GraphQL introducing friction in their develpment process.</li>
<li>At runtime, code cannot easily inspect query results to determine whether a fragment spread or inline fragment was fulfilled or not (for fragments that may be conditionally fulfilled based on their type). There is also no way to refer to the data for a specific fragment in a response: in a response for <code>{a, ...Foo}</code> there is no way for code to reference the value that contains the results for <code>Foo</code> other than to point to the entire response value, which happens to also contain <code>a</code>.</li>
</ul>
<p>For the latter, the best workaround we have found is to inject a meta-field for each fragment spread (ie querying <code>__isFragmentName: __typename</code> for each fragment) and then checking the existence of this key in the response. However, this does not provide a clear way to refer to the results of a particular fragment (ie to pass that result to a child UI component) and has limitations with typical type systems when trying to determine which fragments were or were not evaluated.</p>
<p>For example, given the following fragments:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">fragment Foo on Actor {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...Bar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ... on HasName {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fragment Bar on HasPhoto {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  photo { uri }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>There is no obvious way to determine whether the <code>...Bar</code> or <code>... on HasName</code> selections were evaluated or not. Ideally, developers could do something like <code>if (foo.HasName) { let name = foo.HasName.name }</code> or <code>if (foo.Bar) { /* render Bar component with foo.Bar */ }</code>, but this is only currently possible if a GraphQL client adds an intermediate API and does not directly match the GraphQL response shape. In other words, clients face an ongoing tension in which accurately modeling GraphQL features such as fragments and type refinements requires abandoning GraphQL’s “what you query is what you get” query/response correspondence.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="goal">Goal<a href="#goal" class="hash-link" aria-label="Direct link to Goal" title="Direct link to Goal">​</a></h2>
<p>Our goal with this proposal is to address fragment modularity and the three main challenges above. Specifically:</p>
<ul>
<li>GraphQL should provide a first-class​ syntax for using fragments in a modular way, such that developers can reason locally about fragments as they do with UI components. It should be easy to write code such that by design it cannot violate no-conflicting-alias rule.</li>
<li>Similarly, build tools should be able to exploit this property to avoid whole-program checks when fragments are spread using the modular syntax.</li>
<li>Finally, the new syntax would offer developers a way to easily check which fragments are fulfilled, and refer precisely to the results of a fragment without any unrelated sibling field data.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="prior-art">Prior Art<a href="#prior-art" class="hash-link" aria-label="Direct link to Prior Art" title="Direct link to Prior Art">​</a></h2>
<p>This is not the first time people have argued that a truly modular approach to fragments would improve the language:</p>
<ul>
<li>During GraphQL’s conception, there was debate on whether fragments should be included in the response via copy-paste/merge operations or via independent keys/composition: <a href="https://github.com/graphql/graphql-spec/issues/137#issuecomment-170184907" target="_blank" rel="noopener noreferrer">https://github.com/graphql/graphql-spec/issues/137#issuecomment-170184907</a></li>
<li>Fragment merging concretely required a complex update to our field-merging validation: <a href="https://github.com/graphql/graphql-spec/commit/d481d173749a03e342434070d14fb47116272dfa" target="_blank" rel="noopener noreferrer">https://github.com/graphql/graphql-spec/commit/d481d173749a03e342434070d14fb47116272dfa</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="related-issues">Related Issues<a href="#related-issues" class="hash-link" aria-label="Direct link to Related Issues" title="Direct link to Related Issues">​</a></h2>
<ul>
<li>Fragment Arguments: <a href="https://github.com/graphql/graphql-spec/pull/865" target="_blank" rel="noopener noreferrer">https://github.com/graphql/graphql-spec/pull/865</a></li>
<li>Client Controlled Nullability: <a href="https://github.com/graphql/graphql-spec/pull/895" target="_blank" rel="noopener noreferrer">https://github.com/graphql/graphql-spec/pull/895</a></li>
<li>Error Boundaries (see discussion in Client Defined Nullability)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="solution-space-modularity-via-fragment-response-keys">Solution Space: Modularity via fragment response keys<a href="#solution-space-modularity-via-fragment-response-keys" class="hash-link" aria-label="Direct link to Solution Space: Modularity via fragment response keys" title="Direct link to Solution Space: Modularity via fragment response keys">​</a></h2>
<p>TL;DR: We want to move selection sets towards a model of composing child fragments, as Relay and other native clients already provide.</p>
<p>There are a few different ways we could tackle this problem. One thing people have reached for many times is adding a key into the response that “splits” a fragment’s sub-response into an explicitly keyed sub-tree.</p>
<p>So if we have GraphQL like:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">fragment Foo on Actor {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # replace these spreads with various syntax proposals below</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...Bar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ... on HasName {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fragment Bar on HasAccount {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  account_name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We should get a response like:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;Bar&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;account_name&quot;: &quot;mjmahone&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;HasName&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;name&quot;: &quot;Matt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;id&quot;: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="syntax-0-key-all-fragment-spreads">Syntax #0: key all fragment “spreads”<a href="#syntax-0-key-all-fragment-spreads" class="hash-link" aria-label="Direct link to Syntax #0: key all fragment “spreads”" title="Direct link to Syntax #0: key all fragment “spreads”">​</a></h3>
<p>This proposal basically says that responses by default would now add in a key for each fragment spread and inline fragment spread. So the document described above would have the response with keyed fragments, with no syntax changes needed.</p>
<p>This is very clearly not backwards compatible, but if we were redesigning a new version of GraphQL, might be something we’d want to consider.</p>
<p><strong>Option #0B: Use a directive to turn key-ness on/off</strong></p>
<p>If we’re convinced that by <em>default</em> fragments should be keyed, we could have some directive that changes the shape of the response, a la <code>...Foo @alias</code>. Lee Byron has noted that specification directives should probably not change the response shape: this is not a great option if we want to abide by that logic.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="syntax-1-aliased-spreads-foo-foo">Syntax #1: aliased spreads <code>Foo: ...Foo</code><a href="#syntax-1-aliased-spreads-foo-foo" class="hash-link" aria-label="Direct link to syntax-1-aliased-spreads-foo-foo" title="Direct link to syntax-1-aliased-spreads-foo-foo">​</a></h3>
<p>Allow people to opt-in to getting a keyed fragment sub-response by enabling fragment spreads (inline and named) to be aliased. This makes fragment spreads an alias-able value.</p>
<p>Example Executable:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">fragment Foo on Actor {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Bar: ...Bar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  HasName: ... on HasName {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fragment Bar on HasAccount {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  account_name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If <strong>every</strong> fragment spread was aliased with the above syntax, then we’d have some neat request/response symmetry: every fragment, inline or not, would have their selection set’s response brackets exactly line up with <strong>one</strong> set of <code>{}</code> within the executable document.</p>
<p>Personally, this is @mjmahone&#x27;s current favored potential solution to adding fragment keys to the response.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="syntax-2-aliased-object-foo--foo-">Syntax #2: aliased object <code>Foo: { ...Foo }</code><a href="#syntax-2-aliased-object-foo--foo-" class="hash-link" aria-label="Direct link to syntax-2-aliased-object-foo--foo-" title="Direct link to syntax-2-aliased-object-foo--foo-">​</a></h3>
<p>For this option, we’d allow arbitrary object aliasing. Dan Schafer found this syntax pleasant, as it provides a way to keep brackets matched between the executable document and response. On the other hand, that symmetry ignores that we <em>already</em> have mismatched brackets with inline fragment spreads.</p>
<p>Example Executable:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">fragment Foo on Actor {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Bar: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...Bar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  HasName: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ... on HasName {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fragment Bar on HasAccount {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> account_name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>With this syntax, we could encapsulate arbitrary fields under an alias. However, we <em>already</em> can do that with untyped inline fragment spreads, a la <code>... { some_fields }</code>. It might be cleaner to start considering fragment definitions and inline fragments as &quot;bracket creators&quot; in the response to get the symmetry Dan found pleasing.</p>
<p>Solution #2 could be combined with the Solution #1 to allow arbitrary aliasing of both spreads and arbitrary selection sets, though that might cause more confusion than it would clear up.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="syntax-3-special-syntax-instead-of-">Syntax #3: special syntax instead of <code>...</code><a href="#syntax-3-special-syntax-instead-of-" class="hash-link" aria-label="Direct link to syntax-3-special-syntax-instead-of-" title="Direct link to syntax-3-special-syntax-instead-of-">​</a></h3>
<p>Given <code>...</code> right now has semantic meaning, essentially, of “copy paste conditionally based on type”, it might muddy meaning if we allowed that copy-paste semantic to be used in an aliased way. Therefore, it may be better to have a new syntax to mean “create a key for the inline fragment or fragment spread”. If we used the <code>&amp;</code> symbol, we could have:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">fragment Foo on Actor {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &amp;Bar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &amp; on HasName {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Some options:</p>
<ul>
<li><strong>#Foo</strong>: hashtag sort of means “link” on the web, but in GraphQL is overloaded already to mean “Comment this line”</li>
<li><strong>@Foo</strong>: similarly, <code>@</code> sort of means “link to this other thing”, but again is overloaded, this time for directive usage.</li>
<li><strong>&amp;Foo</strong>: <code>&amp;</code> usually means reference in programming, and that’s kind of what we’re doing here: we’re saying “in this spot in the response, add a reference to the following fragment”. Unfortunately, in both JS and PHP ref values are usually associated with spaghetti code, so it might come off as looking bad</li>
<li>Other options?</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="solution-space-modularity-via-metadata">Solution Space: Modularity via metadata<a href="#solution-space-modularity-via-metadata" class="hash-link" aria-label="Direct link to Solution Space: Modularity via metadata" title="Direct link to Solution Space: Modularity via metadata">​</a></h2>
<p>Another potential option would be to add metadata into the response to indicate which fragments were actually included. One shape of solution is via something like the <a href="https://github.com/graphql/graphql-spec/pull/879" target="_blank" rel="noopener noreferrer"><code>__fulfilled</code> meta-field RFC</a>. Any of these options have the downside of being essentially client compile-time only information, that means what the client needs in order to properly fulfill a product UI starts to stray from what the user actually writes.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="metadata-option-1-add-a-field-that-indicates-whether-a-selection-set-was-fulfilled">Metadata Option 1: Add a field that indicates whether a selection set was fulfilled<a href="#metadata-option-1-add-a-field-that-indicates-whether-a-selection-set-was-fulfilled" class="hash-link" aria-label="Direct link to Metadata Option 1: Add a field that indicates whether a selection set was fulfilled" title="Direct link to Metadata Option 1: Add a field that indicates whether a selection set was fulfilled">​</a></h3>
<p>This is essentially the <code>__fulfilled</code> proposal in <a href="https://github.com/graphql/graphql-spec/pull/879" target="_blank" rel="noopener noreferrer">https://github.com/graphql/graphql-spec/pull/879</a></p>
<p>We could support pretty much any of the fragment-spread-syntax changes above by transforming a selection set like</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Foo: ...Foo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To something like</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ... on HasAccount {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fulfilledFoo: __fulfilled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...Foo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="metadata-option-2-add-information-into-the-responses-extensions">Metadata Option 2: Add information into the response’s <code>extensions</code><a href="#metadata-option-2-add-information-into-the-responses-extensions" class="hash-link" aria-label="Direct link to metadata-option-2-add-information-into-the-responses-extensions" title="Direct link to metadata-option-2-add-information-into-the-responses-extensions">​</a></h3>
<p>This adds metadata around which fragments were included in a response in <code>extensions</code>. It could be used in conjunction with a fragment-spread directive. A downside here is that we’ve just made a non-modular design (all fragments end up in the <code>extensions</code> key, not colocated with their other fragment fields within the response) in order to achieve some semblance of client-facing modularity.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="solution-space-new-response-format">Solution Space: New Response Format<a href="#solution-space-new-response-format" class="hash-link" aria-label="Direct link to Solution Space: New Response Format" title="Direct link to Solution Space: New Response Format">​</a></h2>
<p>A core reason we originally chose not to have a fragment spread represented via a key in the response was due to a worry about duplicating fields many times in the response.</p>
<p>However, it’s possible that GraphQL the Ecosystem would improve if we had some alternative response designs. These responses could encapsulate <strong>more</strong> information than the existing Specification-described JSON response format. Basically, the requirement is likely just that we can go from this new response format to a perfectly valid Specification-described response without losing any Specification-described information, but we may not need to support the inverse (i.e. we could only go from a Spec-response to the New-response in a lossy way).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="response-format-option-1-graph-response">Response Format Option 1: Graph Response<a href="#response-format-option-1-graph-response" class="hash-link" aria-label="Direct link to Response Format Option 1: Graph Response" title="Direct link to Response Format Option 1: Graph Response">​</a></h3>
<p>We might be able to have a more efficient design if the response came back in a Graph form, as opposed to in JSON tree form. You would probably still <strong>access</strong> the graph via tree-shaped structures in client code, but this would format the response similar to how most normalized GraphQL stores that keep data consistent across responses are formatted.</p>
<p>An example of a psuedo-syntax for a response from the query below:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">query {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  me {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...Bar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fragment Bar on HasAccount {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  account_name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>might look something like:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Query {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  me -&gt; User:0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">User:0 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  id: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  account_name: &quot;mjmahone&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Bar -&gt; User:0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this world, the <code>Query.me</code> field points to a specific entity, <code>User</code> with <code>id</code> <code>0</code>.  <code>...Bar</code> is a fragment spread that also points to that same <code>User</code>. If for some reason <code>Bar</code> was unfulfilled in the query (i.e. <code>me</code> does not fulfill <code>HasAccount</code>), the fragment spread pointer could be null.</p>
<p>The above response format would require​ the server understanding how to merge two fields that logically represent the same value, but are present in two completely different places in the request tree. There are many potential ways to solve this problem: above, we&#x27;re solving it by keying each entity by its type and some server-defined “primary key”, but we could make this entity key more explicit or even less formalized within the specification.</p>
<p>We could also combine the new graph response with a new fragment “key” syntax, such that regular fragment spreads still act as inheritance, and only the new keys end up in the graph response. However, given the lower cost for duplicated fields in a graph format, this may not be a major issue.</p>
</blockquote></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/rfcs/wg857"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Fragment Modularity</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/rfcs/wg815"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Nested GraphQL Mutations</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#at-a-glance" class="table-of-contents__link toc-highlight">At a glance</a></li><li><a href="#timeline" class="table-of-contents__link toc-highlight">Timeline</a></li><li><a href="#problem-statement" class="table-of-contents__link toc-highlight">Problem Statement</a></li><li><a href="#goal" class="table-of-contents__link toc-highlight">Goal</a></li><li><a href="#prior-art" class="table-of-contents__link toc-highlight">Prior Art</a></li><li><a href="#related-issues" class="table-of-contents__link toc-highlight">Related Issues</a></li><li><a href="#solution-space-modularity-via-fragment-response-keys" class="table-of-contents__link toc-highlight">Solution Space: Modularity via fragment response keys</a><ul><li><a href="#syntax-0-key-all-fragment-spreads" class="table-of-contents__link toc-highlight">Syntax #0: key all fragment “spreads”</a></li><li><a href="#syntax-1-aliased-spreads-foo-foo" class="table-of-contents__link toc-highlight">Syntax #1: aliased spreads <code>Foo: ...Foo</code></a></li><li><a href="#syntax-2-aliased-object-foo--foo-" class="table-of-contents__link toc-highlight">Syntax #2: aliased object <code>Foo: { ...Foo }</code></a></li><li><a href="#syntax-3-special-syntax-instead-of-" class="table-of-contents__link toc-highlight">Syntax #3: special syntax instead of <code>...</code></a></li></ul></li><li><a href="#solution-space-modularity-via-metadata" class="table-of-contents__link toc-highlight">Solution Space: Modularity via metadata</a><ul><li><a href="#metadata-option-1-add-a-field-that-indicates-whether-a-selection-set-was-fulfilled" class="table-of-contents__link toc-highlight">Metadata Option 1: Add a field that indicates whether a selection set was fulfilled</a></li><li><a href="#metadata-option-2-add-information-into-the-responses-extensions" class="table-of-contents__link toc-highlight">Metadata Option 2: Add information into the response’s <code>extensions</code></a></li></ul></li><li><a href="#solution-space-new-response-format" class="table-of-contents__link toc-highlight">Solution Space: New Response Format</a><ul><li><a href="#response-format-option-1-graph-response" class="table-of-contents__link toc-highlight">Response Format Option 1: Graph Response</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Benjie Gillam; all rights reserved. RFC pages pull content from public GitHub issues/PRs/files/etc; this content remains owned its various authors.</div></div></div></footer></div>
</body>
</html>