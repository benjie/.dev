---
identifier: "793"
title: Default value coercion rules
stage: "2"
champion: benjie
prUrl: https://github.com/graphql/graphql-spec/pull/793
events:
  - type: wgAgenda
    href: https://github.com/graphql/graphql-wg/blob/main//12-Dec/07-wg-primary.md
    date: 2023-12-07
    actor: null
  - type: wgNotes
    href: https://github.com/graphql/graphql-wg/blob/main/023-06.md
    date: 2023-06-30
    actor: null
  - type: wgNotes
    href: https://github.com/graphql/graphql-wg/blob/main/023-06.md
    date: 2023-06-30
    actor: null
  - type: wgAgenda
    href: https://github.com/graphql/graphql-wg/blob/main//06-Jun/01-wg-primary.md
    date: 2023-06-01
    actor: null
  - type: wgNotes
    href: https://github.com/graphql/graphql-wg/blob/main/023-03.md
    date: 2023-03-31
    actor: null
  - type: wgNotes
    href: https://github.com/graphql/graphql-wg/blob/main/023-03.md
    date: 2023-03-31
    actor: null
  - type: wgAgenda
    href: https://github.com/graphql/graphql-wg/blob/main//03-Mar/02-wg-primary.md
    date: 2023-03-02
    actor: null
  - type: wgNotes
    href: https://github.com/graphql/graphql-wg/blob/main/023-02.md
    date: 2023-02-28
    actor: null
  - type: wgNotes
    href: https://github.com/graphql/graphql-wg/blob/main/023-02.md
    date: 2023-02-28
    actor: null
  - type: wgAgenda
    href: https://github.com/graphql/graphql-wg/blob/main//02-Feb/02-wg-primary.md
    date: 2023-02-02
    actor: null
  - type: wgAgenda
    href: https://github.com/graphql/graphql-wg/blob/main//2022-01-06.md
    date: 2022-01-06
    actor: null
  - type: wgNotes
    href: https://github.com/graphql/graphql-wg/blob/main/022-01-06.md
    date: 2022-01-06
    actor: null
  - type: wgNotes
    href: https://github.com/graphql/graphql-wg/blob/main/022-01-06.md
    date: 2022-01-06
    actor: null
  - type: wgAgenda
    href: https://github.com/graphql/graphql-wg/blob/main//2021-05-13.md
    date: 2021-05-13
    actor: null
  - type: wgNotes
    href: https://github.com/graphql/graphql-wg/blob/main/021-05-13.md
    date: 2021-05-13
    actor: null
  - type: wgNotes
    href: https://github.com/graphql/graphql-wg/blob/main/021-05-13.md
    date: 2021-05-13
    actor: null
  - type: wgAgenda
    href: https://github.com/graphql/graphql-wg/blob/main//2021-03-04.md
    date: 2021-03-04
    actor: null
  - type: wgNotes
    href: https://github.com/graphql/graphql-wg/blob/main/021-03-04.md
    date: 2021-03-04
    actor: null
  - type: wgAgenda
    href: https://github.com/graphql/graphql-wg/blob/main//2021-01-07.md
    date: 2021-01-07
    actor: null
  - type: wgNotes
    href: https://github.com/graphql/graphql-wg/blob/main/021-01-07.md
    date: 2021-01-07
    actor: null
  - type: wgNotes
    href: https://github.com/graphql/graphql-wg/blob/main/021-01-07.md
    date: 2021-01-07
    actor: null
  - type: wgNotes
    href: https://github.com/graphql/graphql-wg/blob/main/021-01-07.md
    date: 2021-01-07
    actor: null
  - type: wgNotes
    href: https://github.com/graphql/graphql-wg/blob/main/021-01-07.md
    date: 2021-01-07
    actor: null
  - type: wgNotes
    href: https://github.com/graphql/graphql-wg/blob/main/021-01-07.md
    date: 2021-01-07
    actor: null
  - type: wgAgenda
    href: https://github.com/graphql/graphql-wg/blob/main//2020-12-03.md
    date: 2020-12-03
    actor: null
  - type: wgNotes
    href: https://github.com/graphql/graphql-wg/blob/main/020-12-03.md
    date: 2020-12-03
    actor: null
  - type: prCreated
    date: 2020-11-13T12:23:11Z
    href: https://github.com/graphql/graphql-spec/pull/793
    actor: benjie
shortname: Default value coercion rules
---

## At a glance

- **Identifier**: #793
- **Stage**: [RFC2: Draft](https://github.com/graphql/graphql-spec/blob/main/CONTRIBUTING.md#stage-2-draft)
- **Champion**: [@benjie](https://github.com/benjie)
- **PR**: [Default value coercion rules](https://github.com/graphql/graphql-spec/pull/793)

<!-- BEGIN_CUSTOM_TEXT -->



<!-- END_CUSTOM_TEXT -->

## Timeline

- **Added to [2023-12-07 WG agenda](https://github.com/graphql/graphql-wg/blob/main//12-Dec/07-wg-primary.md)**
- **Mentioned in [2023-06-30 WG notes](https://github.com/graphql/graphql-wg/blob/main/023-06.md)**
- **Mentioned in [2023-06-30 WG notes](https://github.com/graphql/graphql-wg/blob/main/023-06.md)**
- **Added to [2023-06-01 WG agenda](https://github.com/graphql/graphql-wg/blob/main//06-Jun/01-wg-primary.md)**
- **Mentioned in [2023-03-31 WG notes](https://github.com/graphql/graphql-wg/blob/main/023-03.md)**
- **Mentioned in [2023-03-31 WG notes](https://github.com/graphql/graphql-wg/blob/main/023-03.md)**
- **Added to [2023-03-02 WG agenda](https://github.com/graphql/graphql-wg/blob/main//03-Mar/02-wg-primary.md)**
- **Mentioned in [2023-02-28 WG notes](https://github.com/graphql/graphql-wg/blob/main/023-02.md)**
- **Mentioned in [2023-02-28 WG notes](https://github.com/graphql/graphql-wg/blob/main/023-02.md)**
- **Added to [2023-02-02 WG agenda](https://github.com/graphql/graphql-wg/blob/main//02-Feb/02-wg-primary.md)**
- **Added to [2022-01-06 WG agenda](https://github.com/graphql/graphql-wg/blob/main//2022-01-06.md)**
- **Mentioned in [2022-01-06 WG notes](https://github.com/graphql/graphql-wg/blob/main/022-01-06.md)**
- **Mentioned in [2022-01-06 WG notes](https://github.com/graphql/graphql-wg/blob/main/022-01-06.md)**
- **Added to [2021-05-13 WG agenda](https://github.com/graphql/graphql-wg/blob/main//2021-05-13.md)**
- **Mentioned in [2021-05-13 WG notes](https://github.com/graphql/graphql-wg/blob/main/021-05-13.md)**
- **Mentioned in [2021-05-13 WG notes](https://github.com/graphql/graphql-wg/blob/main/021-05-13.md)**
- **Added to [2021-03-04 WG agenda](https://github.com/graphql/graphql-wg/blob/main//2021-03-04.md)**
- **Mentioned in [2021-03-04 WG notes](https://github.com/graphql/graphql-wg/blob/main/021-03-04.md)**
- **Added to [2021-01-07 WG agenda](https://github.com/graphql/graphql-wg/blob/main//2021-01-07.md)**
- **Mentioned in [2021-01-07 WG notes](https://github.com/graphql/graphql-wg/blob/main/021-01-07.md)**
- **Mentioned in [2021-01-07 WG notes](https://github.com/graphql/graphql-wg/blob/main/021-01-07.md)**
- **Mentioned in [2021-01-07 WG notes](https://github.com/graphql/graphql-wg/blob/main/021-01-07.md)**
- **Mentioned in [2021-01-07 WG notes](https://github.com/graphql/graphql-wg/blob/main/021-01-07.md)**
- **Mentioned in [2021-01-07 WG notes](https://github.com/graphql/graphql-wg/blob/main/021-01-07.md)**
- **Added to [2020-12-03 WG agenda](https://github.com/graphql/graphql-wg/blob/main//2020-12-03.md)**
- **Mentioned in [2020-12-03 WG notes](https://github.com/graphql/graphql-wg/blob/main/020-12-03.md)**
- **[Spec PR](https://github.com/graphql/graphql-spec/pull/793) created** on 2020-11-13 by benjie

<!-- VERBATIM -->

---

[Coercing Field Arguments](http://spec.graphql.org/draft/#sec-Coercing-Field-Arguments) states:

> 5.c. Let defaultValue be the default value for argumentDefinition.
> [...]
> 5.h. If hasValue is not true and defaultValue exists (including null):
> 5.h.i. Add an entry to coercedValues named argumentName with the value defaultValue.
> [...]
> 5.j.iii.1. If value cannot be coerced according to the input coercion rules of argumentType, throw a field error.
> 5.j.iii.2. Let coercedValue be the result of coercing value according to the input coercion rules of argumentType.
> 5.j.iii.3. Add an entry to coercedValues named argumentName with the value coercedValue.

Here we note that there is no run-time coercion of `defaultValue`, which makes sense (why do at runtime that which can be done at build time?). However, there doesn't seem to be a rule that specifies that `defaultValue` must be coerced at all, which leads to consequences:

1. you could use any value for defaultValue and it could break the type safety guarantees of GraphQL
2. [nested defaultValues are not applied](https://github.com/graphql/graphql-js/issues/385)

When building the following GraphQL schema programmatically (code below) with GraphQL.js:

```graphql
type Query {
  example(inputObject: ExampleInputObject! = {}): Int
}

input ExampleInputObject {
  number: Int! = 3
}
```

And a resolver for `Query.example`:

```js
resolve(source, args) {
  return args.inputObject.number;
}
```

You might expect the following queries to all gave the same result:

```graphql
query A {
  example
}
query B {
  example(inputObject: {})
}
query C {
  example(inputObject: { number: 3 })
}
query D($inputObject: ExampleInputObject! = {}) {
  example(inputObject: $inputObject)
}
```

However, it turns out that query A's result differs:

```json
{"example":null}
{"example":3}
{"example":3}
{"example":3}
```

This is because `defaultValue` for `Query.example(inputObject:)` was not coerced, so none of the defaultValues of `ExampleInputObject` were applied.

This is extremely unexpected, because looking at the GraphQL schema definition it looks like there's no circumstance under which `ExampleInputObject` may not have `number` as an integer; however when the `defaultValue` of `Query.example(inputObject:)` is used, the value of `number` is `undefined`.

<details>
<summary>Example runnable with GraphQL.js</summary>

```js
const {
  graphqlSync,
  printSchema,
  GraphQLSchema,
  GraphQLObjectType,
  GraphQLInputObjectType,
  GraphQLInt,
  GraphQLNonNull,
} = require("graphql");

const ExampleInputObject = new GraphQLInputObjectType({
  name: "ExampleInputObject",
  fields: {
    number: {
      type: new GraphQLNonNull(GraphQLInt),
      defaultValue: 3,
    },
  },
});

const Query = new GraphQLObjectType({
  name: "Query",
  fields: {
    example: {
      args: {
        inputObject: {
          type: new GraphQLNonNull(ExampleInputObject),
          defaultValue: {},
        },
      },
      type: GraphQLInt,
      resolve(source, args) {
        return args.inputObject.number;
      },
    },
  },
});

const schema = new GraphQLSchema({
  query: Query,
});

console.log(printSchema(schema));

// All four of these should be equivalent?
const source = /* GraphQL */ `
  query A {
    example
  }
  query B {
    example(inputObject: {})
  }
  query C {
    example(inputObject: { number: 3 })
  }
  query D($inputObject: ExampleInputObject! = {}) {
    example(inputObject: $inputObject)
  }
`;
const result1 = graphqlSync({ schema, source, operationName: "A" });
const result2 = graphqlSync({ schema, source, operationName: "B" });
const result3 = graphqlSync({ schema, source, operationName: "C" });
const result4 = graphqlSync({ schema, source, operationName: "D" });

console.log(JSON.stringify(result1.data));
console.log(JSON.stringify(result2.data));
console.log(JSON.stringify(result3.data));
console.log(JSON.stringify(result4.data));
```

</details>

This was [raised against GraphQL.js back in 2016](https://github.com/graphql/graphql-js/issues/385), but @IvanGoncharov closed it early last year stating that GraphQL.js conforms to the GraphQL Spec in this regard.

My proposal is that when a `defaultValue` is specified, the GraphQL implementation should coerce it to conform to the relevant type just like it does for runtime values as specified in [Coercing Variable Values](https://spec.graphql.org/draft/#sec-Coercing-Variable-Values) and [Coercing Field Arguments](https://spec.graphql.org/draft/#sec-Coercing-Field-Arguments).

---

This is validated for query documents (and schema defined as SDL), because:

> Literal values must be compatible with the type expected in the position they are found as per the coercion rules defined in the Type System chapter.
> -- http://spec.graphql.org/draft/#sel-FALXDFDDAACFAhuF

But there doesn't seem to be any such assertion for GraphQL schemas defined in code.
